/**
 * @author bal
**/
package BaseDonnees;

import java.sql.*;

public class RecupInfoDB extends Thread
{
	
	String url = "jdbc:mysql://172.29.1.27:3308/base_de_donnee_projet?zeroDatetimeBehavior=CONVERT_TO_NULL&serverTimezone=UTC";
	String login = "root";
	String password = "";
	Connection con = null;
	Statement smt = null;
	ResultSet rs = null;
	String VilleOWM = "";
	String TemperatureOWM = "";
	String MeteoOWM = "";
	String HumiditeOWM = "";
	String PressionOWM = "";
		
	public void run()
	{
		Connexion();
		//	getVilleMeteoscope();
		//	getTempMeteoscope();
		try {
			EnvoiDataBase();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
		
		public void Connexion()
		{
			try
			{
				Class.forName("com.mysql.cj.jdbc.Driver");
				con = DriverManager.getConnection(url, login, password);
				System.out.println("Connecté");
			}
			catch (SQLException e)
			{
				e.printStackTrace();
			}
			catch (ClassNotFoundException e)
			{
				e.printStackTrace();
			}
		}
		
		public String getVilleMeteoscope(String VilleDB)
		{
			
			
			return VilleDB;
		}
		
		public String getTempMeteoscope(String MeteoDB)
		{
			
				
			return MeteoDB;
		}
	
	public void EnvoiDataBase() throws SQLException
	{
		smt = con.createStatement();
		String sql = "INSERT INTO `use_meteoscope` (`nom_ville`, `meteo_ville`, `temp_ville`, `humidite_ville`, `pression_ville`) VALUES ('"+ VilleOWM +"', '"+ MeteoOWM +"', '"+ TemperatureOWM +"', '"+ HumiditeOWM +"', '"+ PressionOWM +"')";
		smt.executeUpdate(sql);
	}
	
}
